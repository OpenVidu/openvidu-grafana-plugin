# openvidu-grafana-plugin

## Description

This project is a sample of how to integrate OpenVidu with Grafana.

It uses the [openvidu-video-panel](openvidu-video-panel), which is a grafana panel plugin that allows to show an interactive video integrated with other grafana panels.

This project also contains a grafana dashboard connected to a MySQL database, which is used to store the data of the video panel and datasource for data panels.

The data is generated by a [sql script](mysql/data.sql) that is executed when the MySQL container is started.
This script will generate two tables:
*	**video_metadata**: stores the metadata of the videos (`time` in miliseconds and `value` which represents the second of the video)
* **metrics**: stores the random data for printing time series panel on grafana dashboard (`time` same values to video_metadata table and `value` which is a random number)

Both the Grafana and MySQL containers are started using docker-compose. All the configuration is in the [docker-compose.yml](docker/docker-compose.yml) file.

## Features

* **Video panel**: allows to play and pause a video.
* **Video connected to the TimeSeries panel**: When hovering over the time series panel, the video will be updated to the time of the hovered point.
* **Rewind button**: allows to rewind the video to 10 seconds ago.
* **Forward button**: allows to forward the video to 10 seconds later.
* **Video panel with annotations**: allows to add a marker to the time series panel in the current time of the video.

* **Skip to next annotation**: allows to skip to the next annotation in the time series panel.
* **Skip to previous annotation**: allows to skip to the previous annotation in the time series panel.
* **Annotation progress**: when video is playing the annotation progress will be updated and it is represented by a red line in the time series panel.


## Requirements

The following technologies must be installed in your computer

* Docker Compose
* NodeJS and npm
* yarn: `npm install --global yarn`


## Run this sample

1.  Runnin the openvidu-video-panel project:

Under `openvidu-video-panel` path:

```bash
yarn build
```

2. Running MySQL and Grafana

```bash
yarn server
```

Once every service is ready, you can access to the grafana dashboad on [localhost:3000](http://localhost:3000/d/2xkhR8Y4k/openvidu_dashboard?orgId=1)


## Screenshots

![Home](docs/1.png "Home")

![Annotations](docs/2.png "Annotations")









